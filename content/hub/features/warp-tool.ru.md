---
title: "Инструмент деформации"
type: docs
---
Инструмент «Деформация» свободно перемещает, тянет и перемещает пиксели по холсту. В Lumi он идет дальше, чем большинство реализаций: он может деформировать всю группу слоев — независимо от того, сколько вложенных слоев и масок она содержит — как единый объект, не сглаживая и не теряя какой-либо структуры.

## Обзор

Выберите слой и перетащите его, чтобы сместить пиксели в любом направлении. Деформация не является разрушительной во время работы: вы можете отменить и повторить отдельные мазки, изменить размер кисти или поведение между мазками и продолжать работу до тех пор, пока не зафиксируете их. При фиксации накопленная карта смещения деструктивно применяется к пиксельным данным слоя.

Если выбран **групповой слой**, инструмент работает со всей группой в целом. Вы видите и взаимодействуете с предварительным просмотром всей составной группы в реальном времени. При фиксации одна и та же деформация применяется точно и независимо к каждому дочернему слою и маске внутри группы, сохраняя полную структуру слоя.

## Групповое искажение

Деформация группы — это основная возможность, которая отличает инструмент деформации Lumi.

### Проблема, которую он решает

В большинстве программ рисования для деформации многослойной иллюстрации требуется либо сначала сгладить группу (разрушая структуру слоев), либо деформировать каждый слой отдельно и пытаться сопоставить их на глаз (утомительно и неточно). Ни один из подходов не сохраняет исходную структуру для дальнейшего неразрушающего редактирования.

Люми искажает всю группу как один элемент, а затем распределяет ту же трансформацию на каждый слой внутри нее.

### Как это работает

Когда вы выбираете группу и начинаете обводку деформации, Lumi создает **плавающий слой предварительного просмотра** из составной проекции группы. Если у группы есть маска, она запекается в предварительном просмотре, поэтому предварительный просмотр точно отражает окончательный вид. Вы рисуете штрихи деформации прямо на этом предварительном просмотре — то, что вы видите, именно то, что вы получаете.

При фиксации, Люми:

1. Применяет смещение к каждому базовому слою внутри группы (включая глубоко вложенные слои в подгруппах), расширяя холст каждого слоя ровно настолько, чтобы охватить всю область деформации.
2. Применяет одинаковое смещение к каждой маске внутри группы за один проход.
3. Возобновляет автоматический расчет границ группы, чтобы размер группы изменялся в соответствии со своими недавно деформированными дочерними элементами.
4. Обрезает каждый деформированный слой до его фактического нарисованного содержимого, чтобы сохранить компактные размеры файлов.
5. Удаляет слой предварительного просмотра и восстанавливает групповую проекцию из обновленных дочерних элементов.

Все это происходит за один шаг отмены. После фиксации группа выглядит точно так же, как в предварительном просмотре, с сохранением всех слоев и масок.

### Маски

Параметр **Маски деформации** (включен по умолчанию) приводит к тому, что маски на каждом слое и группе внутри цели деформации получают идентичное преобразование смещения. Маски слоев перемещаются вместе со своими слоями: маска, которая обрезала контур персонажа, продолжает обрезать тот же контур после деформации.

Если параметр **Маски деформации** отключен, смещается только содержимое слоя; маски сохраняют исходное положение.

## Параметры инструмента

### Поведение

| Режим | Эффект |
| :--- | :--- |
| **Переместить** | Сдвигает пиксели в направлении штриха. Основной режим для большинства работ по деформированию. |
| **Расти** | Расширяет пиксели наружу от центра кисти. |
| **Уменьшить** | Тянет пиксели внутрь к центру кисти. |
| **Вращение по часовой стрелке** | Поворот пикселей по часовой стрелке вокруг центра кисти. |
| **Вращение против часовой стрелки** | Поворачивает пиксели против часовой стрелки вокруг центра кисти. |
| **Стереть** | Удаляет смещение деформации, возвращая пиксели в исходное положение. |
| **Гладкая** | Рассеивает смещение, смягчая резкие переходы между деформированными и недеформированными областями. |

### Управление кистью

- **Размер**: диаметр кисти деформации в пикселях. Кисти большего размера смещают более широкие области с более мягким спадом; Щетки меньшего размера обеспечивают точный и локализованный контроль.
- **Твердость**: спад от центра к краю. Высокая твердость обеспечивает равномерное смещение по всей площади щетки; низкая твердость концентрирует эффект в центре.
- **Сила**: насколько далеко пиксели смещаются за один штрих. Более низкая прочность обеспечивает тонкую, постепенную форму; более высокая сила обеспечивает драматические, быстрые движения.

### Время удара

- **Штрих во время движения** (только в режиме перемещения): деформация применяется постоянно при движении мыши, а не только по импульсу таймера. Используйте для плавных мазков, похожих на кисть, где вы хотите, чтобы перемещение непосредственно следовало за курсором.
- **Периодическое перемещение**: применяет деформацию через фиксированный интервал времени, пока удерживается кнопка мыши. Используйте для режимов «Расширение», «Сжатие» и «Вихрь», где целью является непрерывное круговое нанесение.
- **Частота**: частота периодического нанесения ударов.

### Качество

- **Интерполяция**: метод выборки, используемый при фиксации. Линейный режим работает быстро и плавно для большинства задач; Cubic и Nohalo обеспечивают более высокую точность воспроизведения мелких деталей.
- **Предварительный просмотр в высоком качестве**: во время интерактивного предварительного просмотра используется сэмплер качества фиксации. Медленнее, но предварительный просмотр точно соответствует зафиксированному результату.

### Параметры группы

- **Расширить область деформации** (только групповая деформация): количество пикселей, добавленных в виде прозрачного поля вокруг предварительного просмотра группы со всех сторон. Это дает перемещенному содержимому пространство для перемещения. Размера по умолчанию 256 пикселей достаточно для большинства работ; уменьшите его для больших изображений, где память имеет значение, или увеличьте для очень больших штрихов смещения.
- **Маски деформации**: следует ли применять одинаковую деформацию к слоям и групповым маскам. Включено по умолчанию.

## Отменить и повторить

Каждый штрих представляет собой отдельный шаг отмены в сеансе деформации. **Ctrl+Z** удаляет последний штрих и восстанавливает карту смещения в предыдущее состояние. **Ctrl+Y** (или **Ctrl+Shift+Z**) применяет его повторно. Прежде чем совершить операцию, вы можете просмотреть всю историю инсульта.

Нажатие **Escape** или переключение инструментов отменяет все незафиксированные штрихи и восстанавливает слой(и) в исходное состояние. Никакие изменения не записываются, пока вы явно не зафиксируете их.

## Фиксация

Нажмите кнопку **Зафиксировать** (или нажмите **Ввод**), чтобы применить накопленную деформацию разрушительным образом. Для групповых деформаций это запускает полное многослойное приложение, описанное выше. История отмены для зафиксированной деформации представляет собой одну запись в стеке отмены изображения, которую можно отменить с помощью стандартного **Редактировать → Отменить**.