---
title: "文件恢復"
type: docs
---
Lumi 維護兩個獨立的恢復系統（自動後台保存和手動增量檢查點），均可透過單一對話方塊存取。

## 訪問

**檔案** → **恢復影像**

該對話方塊將會打開，其中預先填入了目前開啟檔案的恢復狀態。使用頂部的檔案選擇器切換到不同的 `.lum` 檔案。

---

## 自動儲存

Lumi 在編輯時定期保存您作品的背景快照。自動儲存被寫入 **單獨的快取目錄**，使工作 `.lum` 檔案保持不變：

```
~/.cache/lumi/autosave/~home~user~projects~my-painting.lum/
```

路徑編碼使用 `~` 作為分隔符號來為每個檔案建立唯一的快取目錄。這意味著即使項目檔案本身遺失或損壞，自動儲存也可用。

- **頻率**：可在 **編輯** → **首選項** → **效能** → 自動儲存間隔中配置。
- **儲存位置**：也在首選項 → 效能中設定。
- **目的**：崩潰恢復。 「恢復影像」對話方塊中的「自動儲存」標籤顯示可用的自動儲存狀態和時間戳記。

當您開啟包含較新自動儲存資料的檔案時，Lumi 會在開啟時通知您。

---

## 增量儲存

增量保存是一個手動檢查點系統，儲存在`recovery/`下**項目檔案**內。結構是：

```
my-painting.lum/recovery/
  └── primary-01.lum/       (full baseline, created on first Ctrl+S)
      ├── delta-0001.lum/   (Ctrl+S checkpoint, only modified buffers)
      ├── delta-0002.lum/
      └── ...
```

在**檔案→儲存**之後寫入新的`primary-NN.lum/`基線。隨後按 Ctrl+S 將建立 `delta-NNNN.lum/` 子目錄，其中僅包含自上次基線以來變更的緩衝區。自動儲存增量和手動儲存增量使用單獨的計數器，因此它們不會幹擾彼此的歷史記錄。

增量保存**預設為停用**，並且必須針對每個項目啟用：

1. **檔案** → **另存為** (Shift+Ctrl+S)。
2. 在「另存為」對話方塊中，選取 **增量儲存** 並可選擇設定 **最大儲存** 限制。
3. 此設定與項目一起存儲，並應用於所有後續的 Ctrl+S 按下。

當您開啟具有比主儲存更新的增量儲存的`.lum` 檔案時，Lumi 會顯示「偵測到增量儲存」提示，提供載入最新檢查點的提示。

---

## 恢復影像對話框

此對話方塊具有三個選項卡和兩個操作按鈕。

### 自動儲存選項卡

列出所選檔案的所有可用自動儲存狀態，以及時間戳記和縮圖（如果可用）。選擇一個狀態並點擊“**恢復**”將其打開。

使用此選項卡可以：
- 崩潰後恢復。
- 從同一會話恢復到較早的狀態。

### 增量選項卡

列出專案文件中儲存的所有檢查點狀態。每個條目都顯示檢查點時間戳記。選擇一個檢查點並點擊“**恢復**”將其打開。

使用此選項卡可以：
- 返回會話中的較早點，而無需儲存單獨的檔案。
- 瀏覽項目的版本歷史記錄。

### 最新標籤

對話方塊開啟時的預設標籤。自動識別自動儲存和增量檢查點的最新可用復原狀態，並顯示其時間戳記。點擊“**恢復**”即可立即加載它，而無需瀏覽各個狀態。

---

## 按鈕

|按鈕|行動|
|--------|--------|
| **恢復** |將選取的恢復狀態開啟為新映像。 |
| **關閉** |關閉對話方塊而不恢復。 |
| **清理舊州......** |打開清理提示（見下文）。 |

---

## 清理舊狀態隨著時間的推移累積復原狀態可能會消耗大量磁碟空間。 **清理舊狀態...**按鈕（對話方塊左下角）開啟活動標籤（自動儲存或增量）的清理提示。

提示顯示：
- 文件有多少個完整保存。
- 它們佔用的總磁碟空間。
- **保留最近的**旋轉按鈕，用於選擇要保留的保存數量。

將**保留最新**設定為 `0` 將刪除所有恢復狀態。完全清理後，下次按 Ctrl+S 將寫入新的主儲存。

---

## 啟動恢復

啟動時，如果 Lumi 檢測到最近打開的文件具有比上次完整保存更新的自動保存數據，它會在加載前顯示恢復提示。您可以接受（載入自動儲存）或關閉（正常開啟主儲存）。