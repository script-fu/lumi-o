---
title: "圖層和無損編輯"
type: docs
---
Lumi 的圖層系統可實現複雜、非破壞性的工作流程，並完全控制混合、遮罩和合成。

## 概述

圖層是結構化插圖的基礎。每個圖層都是獨立的，具有自己的混合模式、不透明度和可選的圖層蒙版。群組可以使用自己的混合和剪切屬性分層嵌套圖層。

## 訪問

**面板** → **圖層**，或右側預設的**圖層**面板。

## 圖層類型

### 油漆層

用於繪製內容的標準柵格圖層。將像素資料儲存為具有可選 Alpha 透明度的 GEGL 緩衝區。

### 圖層群組

用於組織相關層的分層容器。群組可以有自己的混合模式、不透明度和剪切蒙版。團體預測是按需合成的。

### 圖層蒙版

灰階蒙版附加到任何圖層，控制每個像素的不透明度。用白色在蒙版上繪畫會使像素不透明；黑色使它們透明；灰色提供部分不透明度。

## 混合模式

每個圖層都有一個混合模式，決定它如何與下面的圖層組合：

- **正常**：直接不透明混合。
- **乘法**：透過乘以顏色值來變暗。
- **螢幕**：透過反轉、相乘、再次反轉來變亮。
- **疊加**：乘法和螢幕的組合。
- **新增**：加法混合（對顏色值求和）。
- **減法**：減法混合。
- **顏色、色調、飽和度、亮度**：HSL 組件混合。

## 剪切和遮罩

- **合成模式：剪輯到背景**：將圖層的合成模式設定為**剪輯到背景**可將合成限製到下面累積的**聯合**層已建立不透明度的區域。此圖層僅在這些圖層有內容的地方進行繪製，並且無法擴展 Alpha 足跡。這是在「圖層屬性」對話方塊（**複合模式**下拉清單）中按圖層設定的。當圖層的有效合成模式不是「聯合」時，「圖層」面板中的眼睛圖標將替換為合成圖標，以指示非標準合成行為。

  **範例：共享 alpha 形狀：** 在群組中，底層包含透明背景上的實心圓，設定為預設的 **Union** 合成模式。同一組中其上方的每個圖層都設定為 **剪輯到背景**。這些圖層只能在圓圈提供不透明度的地方繪製（一種形狀，多個圖層）。這是一種常見的模式，用於在定義的輪廓內進行著色、陰影和細節處理，而無需擔心溢出。
- **圖層遮色片**：套用灰階蒙版逐像素控制圖層可見性。在面具上塗上白色，露出來；黑色隱藏；灰色提供部分不透明度。
- **純子遮罩**：遮罩作為子項儲存在可繪製堆疊中，以防止轉換期間資料遺失。

## 圖層選取（Alt 鍵）

將滑鼠懸停在畫布上時點擊 **Alt**（左 Alt）即可選擇遊標下方具有可見像素的圖層，無需切換工具或點擊。

### 它是如何運作的

- **按 Alt**：遊標變成十字線，表示拾取模式已啟動。
- **釋放 Alt**：Lumi 在遊標位置拾取最上面的非透明圖層（不透明度 > 25%）並選擇它。此圖層在「圖層」面板中反白顯示，且狀態列顯示**「選取的圖層：『圖層名稱』」**。
- 在畫布上所選圖層的中心點繪製一個把手。當遊標移開時，手柄會減少並消失。

### 層層循環隨後在同一位置每次點擊 Alt 都會選擇該點堆疊中的**下一層**。 Lumi 會記住最後選擇的圖層並跳到下面的圖層。一旦到達堆疊的底部，下一個點擊循環回到該位置的最頂層。這使得透過重複點擊 Alt 可以輕鬆到達複雜場景中的嵌套圖層。

### 取消規則

如果按住 Alt 時發生以下任一情況，則擷取將會取消（放開 Alt 時不會觸發）：

- 按下滑鼠按鈕（左鍵或右鍵）。
- 按下任何其他鍵。

這可確保 Alt 拖曳手勢（例如畫筆大小調整）和 Alt 修改的捷徑正常運作，而不會意外變更活動圖層。

### 限制

- 在**變換**工具操作期間不會啟動圖層拾取； Alt 在那裡有不同的意義。
- 如果有浮動選擇，則不會進行拾取。
- 僅左Alt觸發拾取；右 Alt 被視為標準修飾符。

## 操作

在圖層面板中：

- **建立圖層**：右鍵點選→ **新圖層**，或使用**圖層**選單。
- **複製**：右鍵點選→ **複製**，或**圖層** → **複製**。
- **刪除**：右鍵→ **刪除**，或選擇並按**刪除**。
- **重新排序**：向上或向下拖曳圖層以變更堆疊順序。
- **重新命名**：雙擊圖層名稱。
- **向下合併**：右鍵→ **向下合併**與下面的圖層合併。
- **拼合影像**：**影像** → **拼合影像**合併所有可見圖層。

## 圖層屬性

- **不透明度**：0–100%，控制整體圖層透明度。
- **混合模式**：下拉式選單用於選擇圖層與下方圖層的組合方式。
- **可見/隱藏**：眼睛圖示切換圖層可見性。

## 圖層鎖

鎖定圖示顯示在「圖層」面板標題行中。每個鎖都可以獨立切換。右鍵單擊鎖定圖示可將其設定為獨佔（僅鎖定該類型，解鎖同一圖層上的所有其他類型）。

- **鎖定 Alpha**：防止在透明區域上繪畫。畫筆描邊僅影響已經具有不透明度的像素；完全透明的像素不會被修改。對於在現有形狀內繪畫而不溢出到外部非常有用。

- **鎖定遮罩**：防止編輯圖層遮色片。在此鎖定開啟時，蒙版保持可見且處於作用中狀態，但無法進行繪製或修改。

- **鎖定顏色**：將繪畫鎖定為特定顏色：應用鎖定時的當前前景色。無論活動前景色如何，該圖層上的後續筆劃都使用該儲存的顏色。解鎖會丟棄儲存的顏色。

- **鎖定內容**（鎖定像素）：防止對圖層進行所有像素編輯。不能對該圖層進行繪製、填充、轉換或以其他方式修改。可用於保護成品層。

- **鎖定位置**：防止圖層被移動或變換。此圖層仍可編輯；僅阻止位置變更（移動工具、變換工具）。

- **鎖定可見性**：防止眼睛圖示切換圖層的可見性。保護在編輯期間應始終保持可見（或隱藏）的圖層。

所有鎖定都與項目一起保存並在會話中持續存在。

## 圖層效果 (fx)

透過**濾鏡**選單應用的非破壞性 GEGL 濾鏡將作為圖層上的提交效果存儲，而不是立即修改像素。當某個圖層至少有一個已提交的效果時，該圖層旁邊的「圖層」面板中會出現一個 **fx** 圖示。### 訪問效果彈出窗口

點擊「圖層」面板中圖層行上的 **fx** 圖標，開啟該圖層的 **圖層效果** 彈出視窗。

彈出視窗顯示該圖層的濾鏡堆疊，每個提交的效果按名稱列出，旁邊有一個可見性切換開關。

### 控制

- **可見性眼睛切換**（彈出視窗頂部）：同時開啟或關閉所有效果。
- **每個過濾器可見性切換**：每個過濾器行都有自己的眼睛圖標，可以獨立啟用或停用該效果。
- **編輯**：開啟所選過濾器的設定對話框，允許無損地調整其參數。
- **升高/降低**：在堆疊中向上或向下移動選定的濾鏡，變更套用效果的順序。
- **合併**：將所有目前可見的效果提交到圖層的像素，使變更永久化。如果合併所有效果，則 fx 圖示將被刪除。合併在圖層群組上不可用。
- **刪除**：完全刪除選取的過濾器。如果沒有效果，彈出視窗將自動關閉。

雙擊清單中的篩選器也會開啟其編輯對話方塊。

如果鎖定像素在圖層上處於活動狀態，則 **編輯** 和 **刪除** 將被封鎖。正在編輯過濾器時，無法對過濾器重新排序。

### 新增效果

從 **過濾器** → （任何類別）套用篩選器。如果以活動圖層為目標並且操作非破壞性地運行，則結果將儲存為圖層效果，而不是烘焙到像素資料中。當至少存在一種效果時，fx 圖示會出現在圖層上。

## 圖層屬性對話框

雙擊“圖層”面板中的圖層以開啟“圖層屬性”對話方塊。

### 身份

- **顏色標籤**：「圖層」面板中視覺組織的顏色標籤。

### 複合空間與模式

- **複合空間**：將此圖層與下方的圖層合成時所使用的色彩空間。選項：自動、線性 (RGB)、感知 (RGB)。
- **複合模式**：控制圖層 Alpha 與背景的互動方式。選項包括「並集」（影響所有區域，普通模式的預設）、「剪輯到背景」（僅影響具有現有內容的區域，大多數其他混合模式的預設）和「交集」。

### 大小和偏移

對於現有圖層，**尺寸**將圖層尺寸和蒙版尺寸（如果附加了蒙版）顯示為唯讀標籤。

**圖層偏移**：X 和 Y 微調器控制圖層在畫布上的位置。變更會立即套用，而不是在對話方塊關閉時套用。

如果圖層有遮罩，**遮罩偏移**（遮罩獨立位置的 X 和 Y 微調器）如下所示。

建立新圖層時，寬度和高度欄位以及**填充**下拉清單（前景、背景、白色、透明）將取代唯讀尺寸顯示。

### 圖層屬性（持久性寄生蟲）

對話方塊的下半部包含持久寄生蟲的可捲動名稱/值表（附加到層的任意鍵值元資料）。這些值與項目一起存儲，並且可以從Scheme 腳本介面存取。

- 按一下「名稱」或「值」列中的任意儲存格以進行內聯編輯。
- **新增**：追加一個新的空白行。
- **刪除**：從圖層中刪除選定的行及其寄生蟲。

如果該層沒有持久性寄生蟲，則會顯示三個空起始行。

### 內容狀態底部的唯讀資訊行顯示圖層的目前內容狀態（以及蒙版，如果存在）：**清除**、**統一**或**混合**。 `*` 前綴表示該圖層自上次儲存以來有未儲存的變更。

## 效能

- **快速模式**：在嵌套在組內的單一圖層上進行繪畫時，Lumi 會在筆畫持續時間內臨時將祖先組切換為直通渲染，從而跳過完整的組投影重組。這消除了墨跡書寫和繪畫期間的嵌套投影更新滯後。當筆畫結束、活動圖層變更或儲存之前，完整合成將會恢復。

  當以下任何條件適用於祖先群組時，快速模式將被停用：
  - 此組具有可見的非破壞性濾鏡（濾鏡需要投影緩衝區）。
  - 該組的混合模式不是 **正常** 或 **直通**。
  - 此組有一個直接子級，使用 **Clip to Backdrop** 或 **Intersection** 複合模式（這些需要來自投影緩衝區的背景資料）。

  對於頂級圖層、浮動選區或同時定位多個圖層時，也不會啟動快速模式。

  建立文件以避免繪畫組中的這些情況，在圖層上使用正常混合模式，可確保快速模式在整個墨跡書寫或繪畫會話中保持活動。
- **延遲載入**：大型專案載入速度快；圖層資料僅在需要時載入（例如，當可見或繪製時）。

## 檔案格式

所有圖層、蒙版和屬性均以 Lumi 的開放 `.lum` 格式儲存。該檔案是一個包含各個層緩衝區和元資料的目錄，確保相容性和長期可存取性。