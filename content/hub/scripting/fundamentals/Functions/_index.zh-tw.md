---
title: "功能"
type: docs
weight: 7
---
函數是Scheme 中的核心概念，提供封裝邏輯、實作程式碼重複使用和有效建置腳本的方法。透過函數，您可以建立模組化、可維護的腳本來處理各種任務，從基本操作到 Lumi 中的高階工作流程。

本節介紹了Scheme中的函數，並為理解它們的類型、定義和用途奠定了基礎。後續部分將更深入研究特定的函數類型及其獨特的功能。

## 最小語法和表達式

方案代碼由**表達式**組成。表達式計算出一個值。语法是统一的：括号形成调用，运算符或函数名称在前。

```scheme
(+ 1 2)         ; Adds 1 and 2, resulting in 3
(if #t 1 0)     ; Evaluates to 1 because the condition is true
(list 1 2 3)    ; Creates a list: (1 2 3)
```

因为一切都是表达式，所以控制流自然地适合与函数调用相同的风格。

## 為什麼函數很重要

函數在Scheme中發揮關鍵作用，原因如下：

- **程式碼可重複使用性：** 透過將邏輯封裝到可重複使用元件中來避免重複。
- **模組化：** 將複雜的任務分解為更小的、可管理的部分。
- **動態行為：**接受參數來處理各種輸入或適應不同的情況。
- **更高的抽象：** 透過專注於函數「做什麼」而不是「如何」來簡化邏輯。

## 函數類型概述

Scheme 提供了多種函數構造，每種構造都適合特定的用例：

1. **命名函數**
   这些是使用 `define` 定义的标准函数。它們構成了大多數腳本的支柱。

   ```scheme
   (define (square x)
     (* x x))
   ```

2. **匿名函數**
   也稱為 **lambda 函數**，這些是內聯定義的未命名函數，供一次性使用。

   ```scheme
   (lambda (x) (* x x))
   ```

3. **高階函數**
   將其他函數作為參數或返回函數作為結果的函數，支援強大的抽象，例如映射、過濾和歸約。

   ```scheme
   (map (lambda (x) (* x x)) '(1 2 3 4))  ; Returns (1 4 9 16)
   ```

## 函數的通用語法

Scheme 中的函數具有簡單且一致的語法：

```scheme
(define (function-name parameter1 parameter2 ...)
  body-expression)
```

- **`function-name`:** 函數的名稱。
- **`parameter1, parameter2, ...`:** 函數所採用的參數。
- **`body-expression`:** 调用函数时执行的逻辑。

範例：

```scheme
(define (add x y)
  (+ x y))

(add 3 5)  ; Returns 8
```

## 副作用和全域狀態

在 Lumi 中，许多有用的过程都有**副作用**：它们修改图像、更改可绘制对象、写入文件或显示输出。

- 将副作用隔离在小的、名称明确的程序中。
- 除非需要，否则避免更改全局上下文。
- 當您變更上下文（顏色、畫筆等）時，請使用 `lumi-context-push` 和 `lumi-context-pop` 包裝工作，以便恢復使用者的狀態。